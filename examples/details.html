<html>

	<head>
		<meta charset="utf-8">
		<title>Hello MUI</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<!--标准mui.css-->
		<link rel="stylesheet" href="../css/mui.min.css">
		<!--App自定义的css-->
		<link rel="stylesheet" type="text/css" href="../css/myStyle.css" />
		<link rel="stylesheet" href="../css/iconfont.css">
		<style>
			footer {
				position: fixed;
				width: 100%;
				height: 50px;
				min-height: 50px;
				border-top: 1px solid #BBB;
				left: 0px;
				bottom: 0px;
				overflow: hidden;
				padding: 0px 50px;
				background-color: #FAFAFA;
			}
			
			.footer-left {
				position: absolute;
				width: 50px;
				height: 50px;
				left: 0px;
				bottom: 0px;
				text-align: center;
				vertical-align: middle;
				line-height: 100%;
				padding: 12px 4px;
			}
			
			.footer-center {
				height: 100%;
				padding: 5px 0px;
			}
			
			.footer-center .input-text {
				background: #FFF none repeat scroll 0% 0%;
				border: 1px solid #DDD;
				padding: 10px !important;
				font-size: 16px !important;
				line-height: 18px !important;
				font-family: verdana !important;
				overflow: hidden;
			}
			
			.footer-center .input-sound {
				background-color: #EEE;
			}
			
			.footer-right {
				position: absolute;
				width: 50px;
				height: 50px;
				right: 0px;
				bottom: 0px;
				text-align: center;
				vertical-align: middle;
				line-height: 100%;
				padding: 12px 5px;
				display: inline-block;
			}
			
			.footer-center [class*="input"] {
				width: 100%;
				height: 100%;
				border-radius: 5px;
			}
			
			textarea {
				height: auto;
				resize: none;
			}
		</style>
	</head>

	<body>
		<!--<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left my-css-color"></a>
			<h1 class="mui-title">详情</h1>
			<a class="iconfont icon-fenxiang1 iconfont-juzhong mui-pull-right my-css-color"></a>
		</header>-->
		<div class="mui-content">
			<!--此处为内容块-->
		</div>
		<footer>
			<div class="footer-left">
				<i id='msg-image' class="mui-icon mui-icon-camera" style="font-size: 28px;"></i>
			</div>
			<div class="footer-center">
				<textarea id='msg-text' type="text" class='input-text'></textarea>
				<button id='msg-sound' type="button" class='input-sound' style="display: none;">按住说话</button>
			</div>
			<label for="" class="footer-right">
				<i id='msg-type' class="mui-icon mui-icon-mic"></i>
			</label>
		</footer>
	</body>
	<!------------------------------------------->
	<script src="../js/mui.min.js"></script>
	<script>
		var wzid = 0;
		//监听自定义事件	
		window.addEventListener("updateHeader", function(e) {
			wzid = e.detail.id;
			console.log('调试：文章页面获取的id = ' + wzid);
		});
		var outtime = 10000; //超时
		var url = 'http://192.168.1.83/Mobile/Details'; //loio.wicp.net
		/*
		 * 初始化Mui
		 */
		mui.init({
			swipeBack: true //启用右滑关闭功能
		});
		mui.plusReady(function() {
			var cells = document.body.querySelectorAll('.mui-content');
			console.log('调试：关于页面是否包含内容 = ' + cells.length);
			ajax(); //执行请求	
		});
		//处理点击事件，需要打开原生浏览器
		mui('body').on('tap', 'a', function(e) {
			var href = this.getAttribute('href');
			if (href) {
				if (window.plus) {
					console.log('调试：调用打开设备浏览器！');
					plus.runtime.openURL(href);
				} else {
					location.href = href;
				}
			}
		});
		/* 
		 * 关于页面的ajax拉取
		 */
		var ajax = function() {
			//功能测试url
			//发送数据
			var data = {
				id:wzid
			};
			//Get方式请求html
			mui.ajax(url, {
				data: data,
				type: 'get',
				timeout: outtime,
				success: success,
				dataType: 'html',
				error: throwGeterror
			});
		};
		/*
		 * 成功响应的回调函数
		 */
		var count = 0;
		var success = function(response) {
			//获取Div元素
			var table = document.body.querySelector('.mui-content');
			//ajax拉取得html片段
			var html = response;
			console.log('调试：ajax返回数据字节 = ' + response.length);
			//插入代码片段 在 element 元素的最后一个子元素后面。
			table.insertAdjacentHTML('beforeend', html);
		};
		//异常处理函数
		var throwGeterror = function(xhr, type, errorThrown) {
			//异常处理；
			console.log('调试：异常信息 = ' + type);
			mui.toast("抱歉，链接超时，请重试！");
		};
	</script>

</html>